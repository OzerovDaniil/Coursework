<!DOCTYPE html>
<html lang="uk">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°—É—à—ñ-–ú–∞–π—Å—Ç–µ—Ä - –ü–∞–Ω–µ–ª—å –∫–µ—Ä—É–≤–∞–Ω–Ω—è</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>

<body>
    <div id="header-placeholder"></div>

    <main class="admin-page">
        <section class="admin-hero">
            <h1>–ü–∞–Ω–µ–ª—å –∫–µ—Ä—É–≤–∞–Ω–Ω—è</h1>
            <p class="subtitle">–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–º</p>
        </section>

        <section class="admin-content">
            <div class="admin-grid">
                <div class="admin-card">
                    <h2>–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è</h2>
                    <div class="admin-stats">
                        <div class="stat-item">
                            <span class="stat-value" id="pendingOrders">0</span>
                            <span class="stat-label">–í –æ–±—Ä–æ–±—Ü—ñ</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value" id="preparingOrders">0</span>
                            <span class="stat-label">–ì–æ—Ç—É—é—Ç—å—Å—è</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value" id="readyOrders">0</span>
                            <span class="stat-label">–ì–æ—Ç–æ–≤—ñ</span>
                        </div>
                    </div>
                    <div class="admin-actions">
                        <button class="btn btn-primary" onclick="location.href='/pages/admin/orders.html'">
                            –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è–º–∏
                        </button>
                    </div>
                </div>

                <div class="admin-card">
                    <h2>–ú–µ–Ω—é</h2>
                    <div class="admin-stats">
                        <div class="stat-item">
                            <span class="stat-value" id="totalItems">0</span>
                            <span class="stat-label">–í—Å—å–æ–≥–æ —Å—Ç—Ä–∞–≤</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value" id="activeItems">0</span>
                            <span class="stat-label">–ê–∫—Ç–∏–≤–Ω–∏—Ö</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value" id="popularItems">0</span>
                            <span class="stat-label">–ü–æ–ø—É–ª—è—Ä–Ω–∏—Ö</span>
                        </div>
                    </div>
                    <div class="admin-actions">
                        <button class="btn btn-primary" onclick="location.href='/pages/admin/menu.html'">
                            –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –º–µ–Ω—é
                        </button>
                    </div>
                </div>

                <div class="admin-card">
                    <h2>–°–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏–∫–∏</h2>
                    <div class="admin-stats">
                        <div class="stat-item">
                            <span class="stat-value" id="totalEmployees">0</span>
                            <span class="stat-label">–í—Å—å–æ–≥–æ</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value" id="activeEmployees">0</span>
                            <span class="stat-label">–ê–∫—Ç–∏–≤–Ω–∏—Ö</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value" id="onDutyEmployees">0</span>
                            <span class="stat-label">–ù–∞ –∑–º—ñ–Ω—ñ</span>
                        </div>
                    </div>
                    <div class="admin-actions">
                        <button class="btn btn-primary" onclick="location.href='/pages/admin/employees.html'">
                            –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø–µ—Ä—Å–æ–Ω–∞–ª–æ–º
                        </button>
                    </div>
                </div>

                <div class="admin-card">
                    <h2>–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</h2>
                    <div class="admin-settings">
                        <div class="setting-item">
                            <label>–ì—Ä–∞—Ñ—ñ–∫ —Ä–æ–±–æ—Ç–∏</label>
                            <div class="working-hours">
                                <div class="time-range">
                                    <span>–ü–Ω-–ü—Ç:</span>
                                    <input type="time" id="weekdayStart" value="10:00">
                                    <span>-</span>
                                    <input type="time" id="weekdayEnd" value="22:00">
                                </div>
                                <div class="time-range">
                                    <span>–°–±-–ù–¥:</span>
                                    <input type="time" id="weekendStart" value="11:00">
                                    <span>-</span>
                                    <input type="time" id="weekendEnd" value="23:00">
                                </div>
                            </div>
                        </div>
                        <div class="setting-item">
                            <label>–°—Ç–∞—Ç—É—Å —Ä–µ—Å—Ç–æ—Ä–∞–Ω—É</label>
                            <div class="restaurant-status">
                                <label class="switch">
                                    <input type="checkbox" id="restaurantStatus" checked>
                                    <span class="slider"></span>
                                </label>
                                <span class="status-text">–í—ñ–¥–∫—Ä–∏—Ç–æ</span>
                            </div>
                        </div>
                    </div>
                    <div class="admin-actions">
                        <button class="btn btn-primary" id="saveSettings">
                            –ó–±–µ—Ä–µ–≥—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
                        </button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>–ö–æ–Ω—Ç–∞–∫—Ç–∏</h3>
                <p>üìû +380 44 123 4567</p>
                <p>‚úâÔ∏è info@sushi-master.ua</p>
                <p>üìç –≤—É–ª. –°—É—à–∏—Å—Ç–∞, 1, –º. –ö–∏—ó–≤</p>
            </div>
            <div class="footer-section">
                <h3>–ì—Ä–∞—Ñ—ñ–∫ —Ä–æ–±–æ—Ç–∏</h3>
                <p>–ü–Ω-–ü—Ç: 10:00 - 22:00</p>
                <p>–°–±-–ù–¥: 11:00 - 23:00</p>
            </div>
            <div class="footer-section">
                <h3>–°–ª—ñ–¥–∫—É–π—Ç–µ –∑–∞ –Ω–∞–º–∏</h3>
                <div class="social-links">
                    <a href="#" class="social-link">Facebook</a>
                    <a href="#" class="social-link">Instagram</a>
                    <a href="#" class="social-link">Telegram</a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 –°—É—à—ñ-–ú–∞–π—Å—Ç–µ—Ä. –í—Å—ñ –ø—Ä–∞–≤–∞ –∑–∞—Ö–∏—â–µ–Ω—ñ.</p>
        </div>
    </footer>

    <script type="module">
        fetch('/front/components/header.html')
            .then(r => r.text())
            .then(html => {
                document.getElementById('header-placeholder').innerHTML = html;
                import('/front/js/main.js');
            });
        // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø—É
        document.addEventListener('DOMContentLoaded', async () => {
            const authToken = localStorage.getItem('authToken');
            const userRole = localStorage.getItem('userRole');

            if (!authToken || (userRole !== 'admin' && userRole !== 'employee')) {
                window.location.href = '/index.html';
                return;
            }

            // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            try {
                const stats = await api.getAdminStats();
                updateStats(stats);
            } catch (error) {
                console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:', error);
            }

            // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
            try {
                const settings = await api.getWorkingHours();
                updateSettings(settings);
            } catch (error) {
                console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å:', error);
            }
        });

        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function updateStats(stats) {
            document.getElementById('pendingOrders').textContent = stats.pendingOrders || 0;
            document.getElementById('preparingOrders').textContent = stats.preparingOrders || 0;
            document.getElementById('readyOrders').textContent = stats.readyOrders || 0;
            document.getElementById('totalItems').textContent = stats.totalItems || 0;
            document.getElementById('activeItems').textContent = stats.activeItems || 0;
            document.getElementById('popularItems').textContent = stats.popularItems || 0;
            document.getElementById('totalEmployees').textContent = stats.totalEmployees || 0;
            document.getElementById('activeEmployees').textContent = stats.activeEmployees || 0;
            document.getElementById('onDutyEmployees').textContent = stats.onDutyEmployees || 0;
        }

        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
        function updateSettings(settings) {
            document.getElementById('weekdayStart').value = settings.weekdayStart;
            document.getElementById('weekdayEnd').value = settings.weekdayEnd;
            document.getElementById('weekendStart').value = settings.weekendStart;
            document.getElementById('weekendEnd').value = settings.weekendEnd;
            document.getElementById('restaurantStatus').checked = settings.isOpen;
            updateStatusText(settings.isOpen);
        }

        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–∫—Å—Ç—É —Å—Ç–∞—Ç—É—Å—É
        function updateStatusText(isOpen) {
            const statusText = document.querySelector('.status-text');
            statusText.textContent = isOpen ? '–í—ñ–¥–∫—Ä–∏—Ç–æ' : '–ó–∞–∫—Ä–∏—Ç–æ';
            statusText.className = `status-text ${isOpen ? 'open' : 'closed'}`;
        }

        // –û–±—Ä–æ–±–∫–∞ –∑–º—ñ–Ω–∏ —Å—Ç–∞—Ç—É—Å—É —Ä–µ—Å—Ç–æ—Ä–∞–Ω—É
        document.getElementById('restaurantStatus').addEventListener('change', function () {
            updateStatusText(this.checked);
        });

        // –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
        document.getElementById('saveSettings').addEventListener('click', async () => {
            const settings = {
                weekdayStart: document.getElementById('weekdayStart').value,
                weekdayEnd: document.getElementById('weekdayEnd').value,
                weekendStart: document.getElementById('weekendStart').value,
                weekendEnd: document.getElementById('weekendEnd').value,
                isOpen: document.getElementById('restaurantStatus').checked
            };

            try {
                await api.updateWorkingHours(settings);
                alert('–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑–±–µ—Ä–µ–∂–µ–Ω–æ');
            } catch (error) {
                console.error('–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å:', error);
                alert('–í–∏–Ω–∏–∫–ª–∞ –ø–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å');
            }
        });
    </script>
</body>

</html>